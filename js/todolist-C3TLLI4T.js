import{a7 as e,r as a,c as t,e as o,v as l,n as s,m as d,z as n,a1 as u,t as i,l as r,V as c,h as v,y as p,H as m,s as g,j as f,F as y,p as k,k as h,C}from"./vue-vendor-CN7QqL5n.js";import{a as x,c as D,b as T,I as _}from"./arco-vendor-CJ8hRjkL.js";import{_ as S}from"./index-BXBOOeDQ.js";const b=e("todo",(()=>{const e=e=>{localStorage.setItem("todos",JSON.stringify(e))},o=a((()=>{const e=localStorage.getItem("todos");return e?JSON.parse(e):[]})()),l=t((()=>o.value.filter((e=>!e.completed)).length)),s=t((()=>o.value.filter((e=>e.completed)).length));return{todos:o,addTodo:a=>{const t={id:Date.now(),content:a,completed:!1,createdAt:Date.now()};o.value.push(t),e(o.value)},deleteTodo:a=>{const t=o.value.findIndex((e=>e.id===a));-1!==t&&(o.value.splice(t,1),e(o.value))},toggleTodo:a=>{const t=o.value.find((e=>e.id===a));t&&(t.completed=!t.completed,e(o.value))},editTodo:(a,t)=>{const l=o.value.find((e=>e.id===a));l&&(l.content=t,e(o.value))},activeCount:l,completedCount:s}}),{persist:{key:"todos",storage:localStorage}}),I={class:"todo-container"},V={class:"todo-header"},j={class:"todo-stats"},w={class:"stat-item"},O={class:"stat-value"},z={class:"stat-item"},A={class:"stat-value"},J={class:"todo-input"},K={class:"todo-list"},N=["onDragstart","onDragenter"],B={class:"todo-drag-handle"},U={class:"todo-checkbox"},F={class:"todo-text"},H={class:"todo-date"},L={class:"todo-actions"},q=S(o({__name:"todolist",setup(e){const t=b(),{todos:o,activeCount:S,completedCount:q}=l(t),{addTodo:E,deleteTodo:G,toggleTodo:M,editTodo:P}=t,Q=a(""),R=a(null),W=a(null),X=a(""),Y=a(null),Z=a(-1),$=()=>{Q.value.trim()&&(E(Q.value.trim()),Q.value="")},ee=e=>{X.value.trim()&&P(e.id,X.value.trim()),W.value=null,X.value=""},ae=()=>{Y.value=null,Z.value=-1};return(e,a)=>{const t=v("a-button"),l=v("a-input"),b=v("a-checkbox"),E=v("a-list");return h(),s("div",I,[d("div",V,[a[5]||(a[5]=d("h1",null,"我的待办",-1)),d("div",j,[d("div",w,[a[3]||(a[3]=d("span",{class:"stat-label"},"待完成",-1)),d("span",O,n(u(S)),1)]),d("div",z,[a[4]||(a[4]=d("span",{class:"stat-label"},"已完成",-1)),d("span",A,n(u(q)),1)])])]),d("div",J,[i(l,{modelValue:Q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Q.value=e),placeholder:"添加新的待办事项...",onKeyup:c($,["enter"])},{append:r((()=>[i(t,{type:"primary",onClick:$},{icon:r((()=>[i(u(x))])),default:r((()=>[a[6]||(a[6]=p(" 添加 "))])),_:1})])),_:1},8,["modelValue"])]),d("div",K,[i(E,{data:u(o),loading:!1},{item:r((({item:e,index:v})=>[d("div",{class:g(["todo-item",{"is-completed":e.completed,"is-dragging":Y.value===e}]),draggable:"true",onDragstart:a=>((e,a,t)=>{Y.value=a,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t.toString()))})(a,e,v),onDragend:ae,onDragover:a[2]||(a[2]=m((()=>{}),["prevent"])),onDragenter:m((e=>((e,a)=>{if(!Y.value||Z.value===a)return;Z.value=a;const t=o.value.indexOf(Y.value);if(t!==a){const e=[...o.value];e.splice(t,1),e.splice(a,0,Y.value),o.value=e,localStorage.setItem("todos",JSON.stringify(e))}})(0,v)),["prevent"])},[d("div",B,[i(u(D))]),d("div",U,[i(b,{"model-value":e.completed,onChange:()=>{return a=e.id,void M(a);var a}},null,8,["model-value","onChange"])]),d("div",{class:g(["todo-content",{completed:e.completed}])},[W.value&&W.value.id===e.id?(h(),f(l,{key:1,modelValue:X.value,"onUpdate:modelValue":a[1]||(a[1]=e=>X.value=e),onBlur:a=>ee(e),onKeyup:c((a=>ee(e)),["enter"]),ref_key:"editInput",ref:R},null,8,["modelValue","onBlur","onKeyup"])):(h(),s(y,{key:0},[d("span",F,n(e.content),1),d("span",H,n(new Date(e.createdAt).toLocaleDateString()),1)],64))],2),d("div",L,[W.value&&W.value.id===e.id?k("",!0):(h(),f(t,{key:0,type:"text",size:"small",onClick:a=>(e=>{W.value={...e},X.value=e.content,C((()=>{var e;null==(e=R.value)||e.focus()}))})(e)},{icon:r((()=>[i(u(T))])),_:2},1032,["onClick"])),i(t,{type:"text",status:"danger",size:"small",onClick:()=>{return a=e.id,void G(a);var a}},{icon:r((()=>[i(u(_))])),_:2},1032,["onClick"])])],42,N)])),_:1},8,["data"])])])}}}),[["__scopeId","data-v-e426b4ae"]]);export{q as default};
