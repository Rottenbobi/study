import{a7 as e,a as t,r as a,e as o,w as l,j as n,l as r,h as s,m as i,u,z as d,t as p,n as f,P as c,p as v,a1 as m,F as h,R as g,y as k,k as y,c as z,G as x,H as C}from"./vue-vendor-CN7QqL5n.js";import{I as b,a as B,M as S,b as O}from"./arco-vendor-CJ8hRjkL.js";import{_ as A}from"./index-BXBOOeDQ.js";const _=["#2B7BB9","#4C8DAE","#3A5B8C","#5B7FA6","#6E99B4","#4B6E8C","#5D8BA3"],w=e("luckyDraw",(()=>{const e=e=>{try{localStorage.setItem("luckyWheelPrizes",JSON.stringify(e))}catch(t){}},o=t((()=>{try{const e=localStorage.getItem("luckyWheelPrizes");if(!e)return{};const t=JSON.parse(e),a={};for(const o in t)Array.isArray(t[o])&&(a[o]=t[o].map((e=>({background:e.background||_[Math.floor(Math.random()*_.length)],fonts:Array.isArray(e.fonts)?e.fonts.map((e=>({text:String(e.text||""),top:String(e.top||"40%"),fontSize:String(e.fontSize||"18px"),fontColor:"#ffffff"}))):[{text:"",top:"40%",fontSize:"18px",fontColor:"#ffffff"}]}))));return a}catch(e){return{}}})()),l=a(""),n=a(""),r=a(!1);return{prizeOptions:o,currentOption:l,currentPrize:n,showResult:r,updatePrizes:(t,a)=>{a&&Array.isArray(a)&&(o[t]=a.map((e=>{var t;return{background:e.background||_[Math.floor(Math.random()*_.length)],fonts:[{text:String((null==(t=e.fonts[0])?void 0:t.text)||""),top:"40%",fontSize:"18px",fontColor:"#ffffff"}]}})),e(o))},addNewTag:(t,a)=>{a&&Array.isArray(a)&&(o[t]=a.map((e=>{var t;return{background:e.background||_[Math.floor(Math.random()*_.length)],fonts:[{text:String((null==(t=e.fonts[0])?void 0:t.text)||""),top:"40%",fontSize:"18px",fontColor:"#ffffff"}]}})),l.value=t,e(o))},selectOption:e=>{l.value=e,r.value=!1,n.value=""},setResult:e=>{n.value=e,r.value=!0},deleteTag:t=>{delete o[t],l.value===t&&(l.value=Object.keys(o)[0]||""),e(o)}}}),{persist:!0}),V={class:"tag-edit-form"},M={class:"form-header"},E={class:"form-group"},T={class:"options-container"},U={class:"form-footer"},N=A(o({__name:"PrizeEditModal",props:{modelValue:{type:Boolean},title:{},prizes:{},placeholder:{},addButtonText:{},minItems:{}},emits:["update:modelValue","update:prizes","confirm"],setup(e,{emit:t}){const o=["#2B7BB9","#4C8DAE","#3A5B8C","#5B7FA6","#6E99B4","#4B6E8C","#5D8BA3"],z=e,x=t,C=a([]);l((()=>z.prizes),(e=>{C.value=JSON.parse(JSON.stringify(e))}),{deep:!0,immediate:!0});const O=()=>{x("update:modelValue",!1)},A=()=>{C.value.some((e=>!e.fonts[0].text.trim()))?S.error("选项名称不能为空"):(x("confirm",C.value),x("update:prizes",C.value),x("update:modelValue",!1))},_=()=>{C.value.push({background:o[Math.floor(Math.random()*o.length)],fonts:[{text:"",top:"40%",fontSize:"18px",fontWeight:"600",fontColor:"#ffffff"}]}),x("update:prizes",C.value)};return(e,t)=>{const a=s("a-input"),o=s("a-input-color"),l=s("a-button"),S=s("a-modal");return y(),n(S,{visible:e.modelValue,title:null,onCancel:O,onOk:A,"mask-closable":!1,footer:!1,width:480},{default:r((()=>[i("div",V,[i("div",M,d(e.title),1),u(e.$slots,"header",{},void 0,!0),i("div",E,[i("div",T,[p(g,{name:"list"},{default:r((()=>[(y(!0),f(h,null,c(C.value,((t,s)=>(y(),f("div",{key:s,class:"option-item"},[p(a,{"model-value":t.fonts[0].text,"onUpdate:modelValue":e=>((e,t)=>{C.value[e].fonts[0].text=t,x("update:prizes",C.value)})(s,e),placeholder:e.placeholder,"allow-clear":""},null,8,["model-value","onUpdate:modelValue","placeholder"]),p(o,{"model-value":t.background,"onUpdate:modelValue":e=>((e,t)=>{C.value[e].background=t,x("update:prizes",C.value)})(s,e),"allow-clear":"",class:"color-picker"},null,8,["model-value","onUpdate:modelValue"]),C.value.length>(z.minItems||2)?(y(),n(l,{key:0,type:"text",class:"delete-btn",onClick:e=>(e=>{C.value.splice(e,1),x("update:prizes",C.value)})(s)},{icon:r((()=>[p(m(b))])),_:2},1032,["onClick"])):v("",!0)])))),128))])),_:1})]),i("div",{class:"add-option-btn",onClick:_},[p(m(B)),i("span",null,d(e.addButtonText),1)])]),i("div",U,[p(l,{onClick:O},{default:r((()=>t[0]||(t[0]=[k("取消")]))),_:1}),p(l,{type:"primary",onClick:A},{default:r((()=>t[1]||(t[1]=[k("确定")]))),_:1})])])])),_:3},8,["visible"])}}}),[["__scopeId","data-v-e6aaac1a"]]),P={class:"page-container"},D={class:"luck-draw-container"},I={class:"options-section"},R={key:0,class:"wheel-wrapper"},W={key:1,class:"empty-state"},J={key:0,class:"result-modal"},j={class:"modal-content"},F={class:"result-content"},G={class:"prize-text"},H={class:"modal-footer"},L={class:"form-group"},$=A(o({__name:"luckydraw",setup(e){const t=a(null),o=w(),l=z((()=>o.prizeOptions[o.currentOption]||[])),u=[{padding:"15px",background:"#2B5B8C",fonts:[{text:"摸鱼转盘",top:"10%",fontSize:"16px",fontWeight:"bold",fontColor:"#ffffff"}]}],g=[{radius:"45%",background:"#2B5B8C"},{radius:"40%",background:"#ffffff"},{radius:"35%",background:"#2B5B8C",pointer:!0,fonts:[{text:"开始",top:"-10px",fontSize:"20px",fontWeight:"bold",fontColor:"#ffffff"}]}],A={gutter:8,speed:20,accelerationTime:2500,decelerationTime:2500,fontColor:"#ffffff",fontSize:"18px",fontWeight:"bold"},_=()=>{if(!t.value)return;o.showResult=!1;const e=Math.floor(Math.random()*l.value.length);t.value.play(),setTimeout((()=>{var a;null==(a=t.value)||a.stop(e)}),2500)},V=e=>{o.setResult(e.fonts[0].text)},M=a(!1),E=a([]),T=e=>{o.updatePrizes(o.currentOption,e),S.success("保存成功")},U=["#2B7BB9","#4C8DAE","#3A5B8C","#5B7FA6","#6E99B4","#4B6E8C","#5D8BA3"],$=a(!1),q=a(""),K=a([]),Q=()=>{q.value="",K.value=[{fonts:[{text:"新选项",top:"40%",fontSize:"18px",fontWeight:"600",fontColor:"#ffffff"}],background:U[0]}],$.value=!0},X=e=>{q.value.trim()?q.value in o.prizeOptions?S.error("标签名称已存在"):(o.addNewTag(q.value,e),S.success("添加成功")):S.error("标签名称不能为空")},Y=()=>{E.value=JSON.parse(JSON.stringify(l.value)),M.value=!0};return(e,a)=>{const z=s("a-button"),w=s("lucky-wheel"),U=s("a-input");return y(),f("div",P,[i("div",D,[a[9]||(a[9]=i("div",{class:"title-section"},[i("h1",null,"包摸鱼的"),i("p",{class:"subtitle"},"摸鱼来的工资才是自己的~")],-1)),i("div",I,[(y(!0),f(h,null,c(m(o).prizeOptions,((e,t)=>{var a;return y(),n(z,{key:t,class:"option-btn",type:m(o).currentOption===t?"primary":"outline",onClick:e=>m(o).selectOption(t)},x({default:r((()=>[k(d(t)+" ",1)])),_:2},[(null==(a=m(o).prizeOptions[t])?void 0:a.length)?{name:"icon",fn:r((()=>[p(m(b),{onClick:C((e=>(e=>{o.deleteTag(e),S.success("删除成功")})(t)),["stop"])},null,8,["onClick"])])),key:"0"}:void 0]),1032,["type","onClick"])})),128)),m(o).currentOption?(y(),n(z,{key:0,class:"option-btn",type:"primary",status:"success",onClick:Y},{icon:r((()=>[p(m(O))])),default:r((()=>[a[6]||(a[6]=k(" 编辑奖项 "))])),_:1})):v("",!0),p(z,{class:"option-btn",type:"primary",onClick:Q},{icon:r((()=>[p(m(B))])),default:r((()=>[a[7]||(a[7]=k(" 新增标签 "))])),_:1})]),m(o).currentOption?(y(),f("div",R,[p(w,{ref_key:"myLucky",ref:t,width:"400px",height:"400px",prizes:l.value,blocks:u,buttons:g,"default-config":A,onStart:_,onEnd:V},null,8,["prizes"])])):(y(),f("div",W,a[8]||(a[8]=[i("p",null,"请先添加一个标签和奖项",-1)])))]),m(o).showResult?(y(),f("div",J,[i("div",j,[a[12]||(a[12]=i("div",{class:"modal-header"},[i("div",{class:"confetti-icon"},"🎉"),i("h3",null,"抽奖结果")],-1)),i("div",F,[a[10]||(a[10]=i("p",{class:"result-text"},"恭喜您抽中了",-1)),i("p",G,d(m(o).currentPrize),1)]),i("div",H,[p(z,{type:"primary",size:"large",onClick:a[0]||(a[0]=e=>m(o).showResult=!1)},{default:r((()=>a[11]||(a[11]=[k("太棒了！")]))),_:1})])])])):v("",!0),p(N,{modelValue:M.value,"onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),prizes:E.value,"onUpdate:prizes":a[2]||(a[2]=e=>E.value=e),title:"编辑奖项",placeholder:"奖项名称","add-button-text":"添加奖项","min-items":2,onConfirm:T},null,8,["modelValue","prizes"]),p(N,{modelValue:$.value,"onUpdate:modelValue":a[4]||(a[4]=e=>$.value=e),prizes:K.value,"onUpdate:prizes":a[5]||(a[5]=e=>K.value=e),title:"添加新标签",placeholder:"请输入选项名称","add-button-text":"添加选项","min-items":1,onConfirm:X},{header:r((()=>[i("div",L,[a[13]||(a[13]=i("div",{class:"form-label"},"标签名称",-1)),p(U,{modelValue:q.value,"onUpdate:modelValue":a[3]||(a[3]=e=>q.value=e),placeholder:"请输入标签名称","allow-clear":""},null,8,["modelValue"])])])),_:1},8,["modelValue","prizes"])])}}}),[["__scopeId","data-v-ce689298"]]);export{$ as default};
